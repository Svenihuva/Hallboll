<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hallboll</title>
    <style>
        body { text-align: center; background-color: #f4f4f4; display: flex; flex-direction: column; align-items: center; }
        #gameContainer { position: relative; }
        canvas { background-color: white; border: 2px solid black; display: block; margin: auto; }
        #scoreboard {
            margin-bottom: 10px;
            font-size: 20px;
            color: gray;
        }
    </style>
</head>
<body>
    <div id="startScreen">
        <h1>Hallboll</h1>
        <input type="text" id="playerName" placeholder="Skriv in ditt namn" />
        <button onclick="startGame()">Starta</button>
    </div>
    <div id="gameContainer">
        <div id="scoreboard"></div>
    </div>
    <script>
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        document.getElementById('gameContainer').appendChild(canvas);
        canvas.width = 800;
        canvas.height = 400;
        canvas.style.display = 'none';

        const paddleWidth = 10, paddleHeight = 80;
        const ballSize = 10;
        let playerName = "Player 0";
        let player = { x: 50, y: canvas.height / 2 - paddleHeight / 2, score: 0, wins: 0, speed: 5 };
        let opponents = [
            { name: "Inga-Maj", x: canvas.width - 60, y: canvas.height / 2 - paddleHeight / 2, score: 0, speed: 2, color: "yellow" },
            { name: "Dayal", x: canvas.width - 60, y: canvas.height / 2 - paddleHeight / 2, score: 0, speed: 3, color: "brown" },
            { name: "Anne-Marie", x: canvas.width - 60, y: canvas.height / 2 - paddleHeight / 2, score: 0, speed: 4, color: "pink" },
            { name: "Lennart \"Legenden\"", x: canvas.width - 60, y: canvas.height / 2 - paddleHeight / 2, score: 0, speed: 5, color: "green" },
            { name: "Glenne", x: canvas.width - 60, y: canvas.height / 2 - paddleHeight / 2, score: 0, speed: 6, color: "blue" }
        ];
        let currentOpponentIndex = 0;
        let opponent = opponents[currentOpponentIndex];

        let ball = { x: canvas.width / 2, y: canvas.height / 2, vx: 4, vy: 4, speedMultiplier: 1 };
        let keys = {};

        function startGame() {
            playerName = document.getElementById('playerName').value || "Player 0";
            document.getElementById('startScreen').style.display = 'none';
            canvas.style.display = 'block';
            updateScoreboard();
            loop();
        }

        function updateScoreboard() {
            document.getElementById('scoreboard').innerHTML = `
                BÄST AV 3 | Motståndare: ${opponent.name} | ${playerName}: ${player.score} | ${opponent.name}: ${opponent.score} | Match: ${player.wins + 1}/5
            `;
        }

        function drawObstacles() {
            ctx.fillStyle = 'black';
            ctx.fillRect(250, 50, 300, 60); // Bord med sex stolar runt
            ctx.fillRect(canvas.width - 100, 50, 50, 50); // Byrå
            ctx.fillRect(canvas.width - 80, canvas.height - 40, 60, 40); // Trappa
        }

        function checkCollisions() {
            if (ball.x <= player.x + paddleWidth && ball.y >= player.y && ball.y <= player.y + paddleHeight) {
                ball.vx *= -1;
            }
            if (ball.x >= opponent.x - paddleWidth && ball.y >= opponent.y && ball.y <= opponent.y + paddleHeight) {
                ball.vx *= -1;
            }
            if (ball.y <= 10 || ball.y >= canvas.height - ballSize - 10) ball.vy *= -1;
            if ((ball.x <= 10 && (ball.y > canvas.height / 2 - 30 && ball.y < canvas.height / 2 + 30)) || 
                (ball.x >= canvas.width - 20 && (ball.y > canvas.height / 2 - 30 && ball.y < canvas.height / 2 + 30))) {
                resetBall();
            }
        }

        function resetBall() {
            ball.x = canvas.width / 2;
            ball.y = canvas.height / 2;
            ball.vx = 4 * (Math.random() > 0.5 ? 1 : -1);
            ball.vy = 4 * (Math.random() > 0.5 ? 1 : -1);
        }

        function update() {
            if (keys['ArrowUp'] && player.y > 10) player.y -= player.speed;
            if (keys['ArrowDown'] && player.y < canvas.height - paddleHeight - 10) player.y += player.speed;
            if (keys['ArrowLeft'] && player.x > 10) player.x -= player.speed;
            if (keys['ArrowRight'] && player.x < canvas.width - paddleWidth - 10) player.x += player.speed;
            ball.x += ball.vx;
            ball.y += ball.vy;
            checkCollisions();
            updateScoreboard();
        }

        function loop() {
            update();
            drawObstacles();
            requestAnimationFrame(loop);
        }
        
        document.addEventListener('keydown', (e) => keys[e.key] = true);
        document.addEventListener('keyup', (e) => keys[e.key] = false);
        loop();
    </script>
</body>
</html>
